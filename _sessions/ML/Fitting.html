<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>ML with R</title>
    <meta charset="utf-8" />
    <meta name="author" content=" Data analytics for Psychology and Business               " />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="baselrbootcamp.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# ML with R
### <a href='https://therbootcamp.github.io'> Data analytics for Psychology and Business </a> <br> <a href='https://cdsbasel.github.io/dataanalytics_2021/menu/materials.html'> <i class='fas fa-clock' style='font-size:.9em;'></i> </a>  <a href='https://cdsbasel.github.io/dataanalytics_2021/'> <i class='fas fa-home' style='font-size:.9em;' ></i> </a>  <a href='mailto:dirk.wulff@unibas.ch'> <i class='fas fa-envelope' style='font-size: .9em;'></i> </a> 
### April 2021

---


layout: true

&lt;div class="my-footer"&gt;
  &lt;span style="text-align:center"&gt;
    &lt;span&gt; 
      &lt;img src="https://raw.githubusercontent.com/therbootcamp/therbootcamp.github.io/master/_sessions/_image/by-sa.png" height=14 style="vertical-align: middle"/&gt;
    &lt;/span&gt;
    &lt;a href="https://cdsbasel.github.io/dataanalytics_2021"&gt;
      &lt;span style="padding-left:82px"&gt; 
        &lt;font color="#7E7E7E"&gt;
          https://cdsbasel.github.io/dataanalytics_2021
        &lt;/font&gt;
      &lt;/span&gt;
    &lt;/a&gt;
    &lt;a href="https://therbootcamp.github.io/"&gt;
      &lt;font color="#7E7E7E"&gt;
       Data analytics for Psychology and Business | April 2021
      &lt;/font&gt;
    &lt;/a&gt;
    &lt;/span&gt;
  &lt;/div&gt; 

---









.pull-left45[

# Fitting

&lt;p style="padding-top:1px"&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li class="m1"&gt;&lt;span&gt;Models are actually &lt;high&gt;families of models&lt;/high&gt;, with every parameter combination specifying a different model.&lt;/span&gt;&lt;/li&gt;
&lt;li class="m2"&gt;&lt;span&gt;To fit a model means to &lt;high&gt;identify&lt;/high&gt; from the family of models &lt;high&gt;the specific model that fits the data best&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

]

.pull-right45[

&lt;br&gt;&lt;br&gt;

&lt;p align = "center"&gt;
&lt;img src="image/curvefits.png" height=480px&gt;&lt;br&gt;
&lt;font style="font-size:10px"&gt;adapted from &lt;a href="https://www.explainxkcd.com/wiki/index.php/2048:_Curve-Fitting"&gt;explainxkcd.com&lt;/a&gt;&lt;/font&gt;
&lt;/p&gt;

]

---

# Which is better?

&lt;img src="Fitting_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /&gt;


---

# Which is better?

&lt;img src="Fitting_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;" /&gt;


---

# Loss function

.pull-left45[

&lt;ul&gt;
&lt;li class="m1"&gt;&lt;span&gt;&lt;Possible &lt;high&gt;the most important concept&lt;/high&gt; in statistics and machine learning.&lt;/span&gt;&lt;/li&gt;
&lt;li class="m2"&gt;&lt;span&gt;The loss function defines some &lt;high&gt;summary of the errors committed by the model&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p style="padding-top:7px"&gt;

`$$\Large Loss = f(Error)$$`

&lt;p style="padding-top:7px"&gt;

&lt;u&gt;Two purposes&lt;/u&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;b&gt;Purpose&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    Fitting
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Find parameters that optimize loss function.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    Evaluation
  &lt;/td&gt;
  &lt;td&gt;
    Calculate loss function for fitted model.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]


.pull-right45[

&lt;img src="Fitting_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /&gt;


]

---

# 2 types of supervised problems

.pull-left5[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;b&gt;Regression&lt;/b&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;Prediction of a &lt;high&gt;quantitative criterion&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
    &lt;li&gt;&lt;span&gt;&lt;i&gt;Predict level cholesterol with age&lt;/i&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;&lt;br&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;b&gt;Classification&lt;/b&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;Prediction of a &lt;high&gt;categorical criterion&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
    &lt;li&gt;&lt;span&gt;&lt;i&gt;Predict heart attack yes or no&lt;/i&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;&lt;br&gt;
&lt;/ul&gt;

]

.pull-right4[

&lt;p align = "center"&gt;
&lt;img src="image/twotypes.png" height=440px&gt;&lt;br&gt;
&lt;/p&gt;

]



---

class: center, middle

&lt;high&gt;&lt;h1&gt;Regression&lt;/h1&gt;&lt;/high&gt;

&lt;font color = "gray"&gt;&lt;h1&gt;Decision Trees&lt;/h1&gt;&lt;/font&gt;

&lt;font color = "gray"&gt;&lt;h1&gt;Random Forests&lt;/h1&gt;&lt;/font&gt;


---

# Regression

.pull-left45[

In [regression](https://en.wikipedia.org/wiki/Regression_analysis), the criterion `\(Y\)` is modeled as the &lt;high&gt;sum&lt;/high&gt; of &lt;high&gt;features&lt;/high&gt; `\(X_1, X_2, ...\)` &lt;high&gt;times weights&lt;/high&gt; `\(\beta_1, \beta_2, ...\)` plus `\(\beta_0\)` the so-called the intercept.

&lt;p style="padding-top:10px"&gt;&lt;/p&gt;


`$$\large \hat{Y} =  \beta_{0} + \beta_{1} \times X_1 + \beta_{2} \times X2 + ...$$`

&lt;p style="padding-top:10px"&gt;&lt;/p&gt;

The weight `\(\beta_{i}\)` indiciates the &lt;high&gt;amount of change&lt;/high&gt; in `\(\hat{Y}\)` for a change of 1 in `\(X_{i}\)`.

Ceteris paribus, the &lt;high&gt;more extreme&lt;/high&gt; `\(\beta_{i}\)`, the &lt;high&gt;more important&lt;/high&gt; `\(X_{i}\)` for the prediction of `\(Y\)` &lt;font style="font-size:12px"&gt;(Note: the scale of `\(X_{i}\)` matters too!).&lt;/font&gt;

If `\(\beta_{i} = 0\)`, then `\(X_{i}\)` &lt;high&gt;does not help&lt;/high&gt; predicting `\(Y\)`



]

.pull-right45[

&lt;img src="Fitting_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /&gt;


]


---

# Regression loss

.pull-left45[

&lt;p&gt;

&lt;ul style="margin-bottom:-20px"&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;b&gt;Mean Squared Error (MSE)&lt;/b&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;&lt;high&gt;Average squared distance&lt;/high&gt; between predictions and true values.&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

$$ MSE = \frac{1}{n}\sum_{i \in 1,...,n}(Y_{i} - \hat{Y}_{i})^{2}$$

&lt;ul&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;b&gt;Mean Absolute Error (MAE)&lt;/b&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;&lt;high&gt;Average absolute distance&lt;/high&gt; between predictions and true values.&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

$$ MAE = \frac{1}{n}\sum_{i \in 1,...,n} \lvert Y_{i} - \hat{Y}_{i} \rvert$$


&lt;/p&gt;

]

.pull-right45[

&lt;img src="Fitting_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /&gt;


]


---

# Fitting

.pull-left45[

&lt;p style="margin-top:20px"&gt;
&lt;ul style="margin-bottom:-20px"&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;b&gt;Analytically&lt;/b&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;In rare cases, the parameters can be &lt;high&gt;directly calculated&lt;/high&gt;, e.g., using the &lt;i&gt;normal equation&lt;/i&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;

`$$\boldsymbol \beta = (\boldsymbol X^T\boldsymbol X)^{-1}\boldsymbol X^T\boldsymbol y$$`

&lt;ul&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;b&gt;Numerically&lt;/b&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;In most cases, parameters need to be found using a &lt;high&gt;directed trial and error&lt;/high&gt;, e.g., &lt;i&gt;gradient descent&lt;/i&gt;:&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;

`$$\boldsymbol \beta_{n+1} = \boldsymbol \beta_{n}+\gamma \nabla F(\boldsymbol \beta_{n})$$`

]

.pull-right45[

&lt;p align = "center"&gt;
&lt;img src="image/gradient.png" height=420px&gt;&lt;br&gt;
&lt;font style="font-size:10px"&gt;adapted from &lt;a href="https://me.me/i/machine-learning-gradient-descent-machine-learning-machine-learning-behind-the-ea8fe9fc64054eda89232d7ffc9ba60e"&gt;me.me&lt;/a&gt;&lt;/font&gt;
&lt;/p&gt;

]


---

.pull-left45[

# Fitting

&lt;p style="padding-top:1px"&gt;&lt;/p&gt;

&lt;p style="margin-top:20px"&gt;
&lt;ul style="margin-bottom:-20px"&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;b&gt;Analytical&lt;/b&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;In rare cases, the parameters can be &lt;high&gt;directly calculated&lt;/high&gt;, e.g., using the &lt;i&gt;normal equation&lt;/i&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;

`$$\boldsymbol \beta = (\boldsymbol X^T\boldsymbol X)^{-1}\boldsymbol X^T\boldsymbol y$$`

&lt;ul&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;b&gt;Numerically&lt;/b&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;In most cases, parameters need to be found using a &lt;high&gt;directed trial and error&lt;/high&gt;, e.g., &lt;i&gt;gradient descent&lt;/i&gt;:&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;br&gt;

`$$\boldsymbol \beta_{n+1} = \boldsymbol \beta_{n}+\gamma \nabla F(\boldsymbol \beta_{n})$$`


]

.pull-right45[

&lt;br&gt;&lt;br2&gt;

&lt;p align = "center"&gt;
&lt;img src="image/gradient1.gif" height=250px&gt;&lt;br&gt;
&lt;font style="font-size:10px"&gt;adapted from &lt;a href="https://dunglai.github.io/2017/12/21/gradient-descent/
"&gt;dunglai.github.io&lt;/a&gt;&lt;/font&gt;&lt;br&gt;
&lt;img src="image/gradient2.gif" height=250px&gt;&lt;br&gt;
&lt;font style="font-size:10px"&gt;adapted from &lt;a href="https://dunglai.github.io/2017/12/21/gradient-descent/
"&gt;dunglai.github.io&lt;/a&gt;&lt;/font&gt;
&lt;/p&gt;

]



---
class: center, middle

&lt;font color = "gray"&gt;&lt;h1&gt;Regression&lt;/h1&gt;&lt;/font&gt;

&lt;high&gt;&lt;h1&gt;Decision Trees&lt;/h1&gt;&lt;/high&gt;

&lt;font color = "gray"&gt;&lt;h1&gt;Random Forests&lt;/h1&gt;&lt;/font&gt;

---

# CART

.pull-left45[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;CART is short for &lt;high&gt;Classification and Regression Trees&lt;/high&gt;, which are often simply called Decision trees.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;li class="m2"&gt;&lt;span&gt;Models criterion is modeled as a sequence of &lt;high&gt;logical TRUE or FALSE questions&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

]

.pull-right45[

&lt;p align = "center" style="padding-top:0px"&gt;
&lt;img src="image/tree.png"&gt;
&lt;/p&gt;
]

---

# Regression trees

.pull-left45[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;Classification regression trees are created using a relatively simple &lt;high&gt;three-step algorithm&lt;/high&gt;:&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;ul&gt;
  &lt;li&gt;&lt;span&gt;1 - &lt;high&gt;Split&lt;/high&gt; nodes to maxmize &lt;b&gt;homogeneity&lt;/b&gt; (regression) or purity (classification within nodes.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;li&gt;&lt;span&gt;2 - &lt;high&gt;Repeat&lt;/high&gt; until splits are no longer possible.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;li&gt;&lt;span&gt;3 - &lt;high&gt;Prune&lt;/high&gt; tree to reasonable size.&lt;/mono&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right45[

&lt;p align = "center" style="padding-top:0px"&gt;
&lt;img src="image/tree.png"&gt;
&lt;/p&gt;
]

---

# Homogeneity

.pull-left45[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;Regression trees attempt to maximize homogeneity, which means in turn to &lt;high&gt;minimize within-node variance&lt;/high&gt;&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;&lt;br&gt;

`$$\large SSE = \sum_{i \in S_1}(y_i - \bar{y}_1)^2+\sum_{i \in S_2}(y_i - \bar{y}_2)^2$$`


]



.pull-right45[

&lt;p align = "center" style="padding-top:0px"&gt;
&lt;img src="image/splitting_regr.png"&gt;
&lt;/p&gt;


]





---

# Pruning trees

.pull-left45[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;Regression trees are &lt;high&gt;pruned&lt;/high&gt; back such that every split has a homogeneity gain of at least &lt;high&gt;&lt;mono&gt;cp&lt;/mono&gt;&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;

$$
\large
`\begin{split}
Loss = &amp; Homogeneity\,+\\
&amp;cp*(n\:terminal\:nodes)\\
\end{split}`
$$

]

.pull-right45[


&lt;p align = "center" style="padding-top:0px"&gt;
&lt;img src="image/splitting_regr.png"&gt;
&lt;/p&gt;

]


---
class: center, middle

&lt;font color = "gray"&gt;&lt;h1&gt;Regression&lt;/h1&gt;&lt;/font&gt;

&lt;font color = "gray"&gt;&lt;h1&gt;Decision Trees&lt;/h1&gt;&lt;/font&gt;

&lt;high&gt;&lt;h1&gt;Random Forests&lt;/h1&gt;&lt;/high&gt;

---

.pull-left45[

# Random Forest


&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;In Random Forests the criterion is modeled as the &lt;high&gt;aggregate prediction of &lt;high&gt;many decision trees&lt;/high&gt; each based on different features.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;li class="m2"&gt;&lt;span&gt;Algorithmus:&lt;/span&gt;&lt;/li&gt;
  &lt;ul&gt;
  &lt;li&gt;&lt;span&gt;1 - &lt;high&gt;Repeat&lt;/high&gt; &lt;mono&gt;n&lt;/mono&gt; times.&lt;/li&gt;&lt;/span&gt;&lt;br&gt;
  &lt;ul&gt;
  &lt;li&gt;&lt;span&gt;1 - &lt;high&gt;Resample&lt;/high&gt; data.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;li&gt;&lt;span&gt;2 - Each split &lt;high&gt;consider &lt;i&gt;m&lt;/i&gt; features&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;/ul&gt;
  &lt;li&gt;&lt;span&gt;2 - &lt;high&gt;Average&lt;/high&gt; predictions.&lt;/li&gt;&lt;/span&gt;&lt;br&gt;  
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right45[
&lt;br&gt;

&lt;p align = "center" style="padding-top:0px"&gt;
&lt;img src="image/rf.png"&gt;
&lt;/p&gt;


]

---

# Random Forest

.pull-left45[

&lt;p style="padding-top:1px"&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;Random forests make use of &lt;high&gt;bagging&lt;/high&gt;, which consists of &lt;high&gt;resampling&lt;/high&gt; and &lt;high&gt;averaging&lt;/high&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
  &lt;col width="30%"&gt;
  &lt;col width="70%"&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Element&lt;/b&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;i&gt;Resampling&lt;/i&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Creates new data sets that vary in their composition thereby &lt;high&gt;deemphasizing idiosyncracies&lt;/high&gt; of the available data. 
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;i&gt;Averaging&lt;/i&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Combining predictions typically &lt;high&gt;evens out idiosyncracies&lt;/high&gt; of the models created from single data sets.   
  &lt;/td&gt;  
&lt;/tr&gt;
&lt;/table&gt;
]


.pull-right45[

&lt;p align = "center" style="padding-top:0px"&gt;
&lt;img src="image/tree_crowd.png"&gt;
&lt;/p&gt;


]






---

class: center,  middle

&lt;br&gt;&lt;br&gt;

&lt;h1&gt;&lt;a&gt;Fitten in &lt;mono&gt;caret&lt;/mono&gt;&lt;/h1&gt;



---

# Key functions

.pull-left45[

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Function&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;trainControl()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Choose settings for how fitting should be carried out.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;train()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td&gt;
    Specify the model and find &lt;i&gt;best&lt;/i&gt; parameters.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;postResample()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Evaluate model performance (fitting or prediction) for regression.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;confusionMatrix()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Evaluate model performance (fitting or prediction) for classification.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]

.pull-right45[


```r
# Step 1: Define control parameters
#   trainControl()

ctrl &lt;- trainControl(...) 

# Step 2: Train and explore model
#   train()

mod &lt;- train(...)
summary(mod)
mod$finalModel   # see final model

# Step 3: Assess fit
#   predict(), postResample(), fon

fit &lt;- predict(mod)
postResample(fit, truth)
confusionMatrix(fit, truth)
```



&lt;!-- Caret documentation: [http://topepo.github.io/caret/](http://topepo.github.io/caret/) --&gt;

&lt;!-- &lt;iframe src="http://topepo.github.io/caret/" height="480px" width = "500px"&gt;&lt;/iframe&gt; --&gt;

]

---

# `trainControl()`

.pull-left45[


&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;Controls how &lt;mono&gt;caret&lt;/mono&gt; fits an ML model.&lt;/span&gt;&lt;/li&gt;&lt;br&gt;
  &lt;li class="m2"&gt;&lt;span&gt;Until Session &lt;b&gt;Optimisierung&lt;/b&gt; we use &lt;highm&gt;method = "none"&lt;/highm&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;


```r
# Fit the model without any 
#  advanced parameter tuning methods

ctrl &lt;- trainControl(method = "none")

# show help

?trainControl
```

]

.pull-right45[

&lt;img src="image/traincontrol_help.jpg" width="100%" style="display: block; margin: auto;" /&gt;

]

---

# `train()`

.pull-left4[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;high&gt;Workhorse&lt;/high&gt; for fitting models, offering &lt;high&gt;200+ models&lt;/high&gt; via the &lt;high&gt;method&lt;/high&gt; argument!&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Argument&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;form&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Formula specifying features and criterion.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;data&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td&gt;
    Training data.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;method&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    The model (algorithm). 
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;trControl&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Control parameters for fitting.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;tuneGrid&lt;/mono&gt;, &lt;mono&gt;preProcess&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Cool stuff for later.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]


.pull-right5[

```r
# Fit a regression model predicting Price

income_mod &lt;- 
  train(form = income ~ ., # Formula
        data = basel,   # Training data
        method = "glm",    # Regression
        trControl = ctrl)  # Control Param's
income_mod
```

```
Generalized Linear Model 

1000 samples
  19 predictor

No pre-processing
Resampling: None 
```


]

---

# `train()`

.pull-left4[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;high&gt;Workhorse&lt;/high&gt; for fitting models, offering &lt;high&gt;200+ models&lt;/high&gt; via the &lt;high&gt;method&lt;/high&gt; argument!&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Argument&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;form&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Formula specifying features and criterion.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;data&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td&gt;
    Training data.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;method&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    The model (algorithm). 
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;trControl&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Control parameters for fitting.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;tuneGrid&lt;/mono&gt;, &lt;mono&gt;preProcess&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Cool stuff for later.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]


.pull-right5[


```r
# Fit a random forest predicting Price

income_mod &lt;- 
  train(form = income ~ .,# Formula
        data = basel,  # Training data
        method = "rpart",    # Decision tree
        trControl = ctrl) # Control Param's
income_mod
```

```
CART 

1000 samples
  19 predictor

No pre-processing
Resampling: None 
```

]



---

# `train()`

.pull-left4[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;high&gt;Workhorse&lt;/high&gt; for fitting models, offering &lt;high&gt;200+ models&lt;/high&gt; via the &lt;high&gt;method&lt;/high&gt; argument!&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Argument&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;form&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Formula specifying features and criterion.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;data&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td&gt;
    Training data.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;method&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    The model (algorithm). 
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td&gt;
    &lt;mono&gt;trControl&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Control parameters for fitting.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;tuneGrid&lt;/mono&gt;, &lt;mono&gt;preProcess&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Cool stuff for later.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]


.pull-right5[


```r
# Fit a random forest predicting Price

income_mod &lt;- 
  train(form = income ~ .,# Formula
        data = basel,  # Training data
        method = "rf",    # Random Forest
        trControl = ctrl) # Control Param's
income_mod
```

```
Random Forest 

1000 samples
  19 predictor

No pre-processing
Resampling: None 
```

]


---

.pull-left4[

# `train()`

&lt;p style="padding-top:1px"&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;high&gt;Workhorse&lt;/high&gt; for fitting models, offering &lt;high&gt;200+ models&lt;/high&gt; via the &lt;high&gt;method&lt;/high&gt; argument!&lt;/span&gt;&lt;/li&gt;
  &lt;li class="m2"&gt;&lt;span&gt;Find all 200+ Models &lt;a href="http://topepo.github.io/caret/available-models.html"&gt;here&lt;/a&gt;.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

]


.pull-right5[

&lt;br&gt;&lt;br&gt;

&lt;iframe width="600" height="480" src="https://topepo.github.io/caret/available-models.html" frameborder="0"&gt;&lt;/iframe&gt;

]


---

# `train()`

.pull-left4[

&lt;ul style="margin-bottom:-20px"&gt;
  &lt;li class="m1"&gt;&lt;span&gt;The criterion must be the right type:
  &lt;br&gt;&lt;br&gt;
  &lt;ul class="level"&gt;
    &lt;li&gt;&lt;span&gt;&lt;high&gt;&lt;mono&gt;numeric&lt;/mono&gt;&lt;/high&gt; criterion &amp;rarr; &lt;high&gt;Regression&lt;/high&gt;&lt;br&gt;&lt;/span&gt;&lt;/li&gt;
    &lt;li&gt;&lt;span&gt;&lt;high&gt;&lt;mono&gt;factor&lt;/mono&gt;&lt;/high&gt; criterion &amp;rarr; &lt;high&gt;Klassifkation&lt;/high&gt;&lt;br&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
  &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;


]

.pull-right5[


```r
# Will be a regression task 

loan_mod &lt;- train(form = Default ~ .,
                  data = Loans,
                  method = "glm",
                  trControl = ctrl)

# Will be a classification task

load_mod &lt;- train(form = factor(Default) ~ .,
                  data = Loans,
                  method = "glm",
                  trControl = ctrl)
```

]

---

# &lt;mono&gt;.$finalModel&lt;/mono&gt;

.pull-left4[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;mono&gt;train()&lt;/mono&gt; returns a &lt;mono&gt;list&lt;/mono&gt; with an object called &lt;mono&gt;finalModel&lt;/mono&gt; containing the best fitting model.&lt;/span&gt;&lt;/li&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;mono&gt;.$finalModel&lt;/mono&gt; &lt;high&gt;extracts the model&lt;/high&gt;, then explore using:&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;


&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Function&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;summary()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Overview of the most important results.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;names()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    See all named elements you can access with $.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]

.pull-right5[




```r
# Fit regression model
eink_mod &lt;-
  train(form = income ~ age + height,
        data = basel,       # Data
        method = "glm",     # Regression
        trControl = ctrl)   # Train control

# Show names of final model
names(eink_mod$finalModel)
```

```
[1] "coefficients"  "residuals"     "fitted.values"
[4] "effects"       "R"             "rank"         
 [ reached getOption("max.print") -- omitted 28 entries ]
```

]


---

# &lt;mono&gt;.$finalModel&lt;/mono&gt;

.pull-left4[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;mono&gt;train()&lt;/mono&gt; returns a &lt;mono&gt;list&lt;/mono&gt; with an object called &lt;mono&gt;finalModel&lt;/mono&gt; containing the best fitting model.&lt;/span&gt;&lt;/li&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;mono&gt;.$finalModel&lt;/mono&gt; &lt;high&gt;extracts the model&lt;/high&gt;, then explore using:&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Function&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;summary()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Overview of the most important results.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;names()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    See all named elements you can access with $.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]

.pull-right5[




```r
# Fit regression model
eink_mod &lt;-
  train(form = income ~ age + height,
        data = basel,       # Data
        method = "glm",     # Regression
        trControl = ctrl)   # Train control

# Show coefficients
eink_mod$finalModel$coefficients
```

```
(Intercept)         age      height 
    177.084     151.786       3.466 
```

]

---


.pull-left4[

# &lt;mono&gt;.$finalModel&lt;/mono&gt;

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;mono&gt;train()&lt;/mono&gt; returns a &lt;mono&gt;list&lt;/mono&gt; with an object called &lt;mono&gt;finalModel&lt;/mono&gt; containing the best fitting model.&lt;/span&gt;&lt;/li&gt;
  &lt;li class="m2"&gt;&lt;span&gt;&lt;mono&gt;.$finalModel&lt;/mono&gt; &lt;high&gt;extracts the model&lt;/high&gt;, then explore using:&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;

&lt;table style="cellspacing:0; cellpadding:0; border:none;"&gt;
&lt;tr&gt;
  &lt;td&gt;
  &lt;b&gt;Function&lt;/b&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;b&gt;Description&lt;/b&gt;
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;summary()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    Overview of the most important results.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
  &lt;td bgcolor="white"&gt;
    &lt;mono&gt;names()&lt;/mono&gt;
  &lt;/td&gt;
  &lt;td bgcolor="white"&gt;
    See all named elements you can access with $.
  &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

]

.pull-right5[

&lt;br&gt;&lt;br&gt;




```r
# Show model output
summary(eink_mod)
```

```

Call:
NULL

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
 -3567    -773      30     793    4186  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   177.08     498.81    0.36     0.72    
 [ reached getOption("max.print") -- omitted 2 rows ]
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 1380255)

    Null deviance: 7687291073  on 999  degrees of freedom
Residual deviance: 1376114147  on 997  degrees of freedom
AIC: 16981

Number of Fisher Scoring iterations: 2
```

]



---

# `predict()`

.pull-left5[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;high&gt;Produces predictions&lt;/high&gt; from a model. Simply put model object as the first argument.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;




```r
# Extrahiere gefittete Werte
glm_fits &lt;- predict(object = eink_mod)
glm_fits[1:8]
```

```
    1     2     3     4     5     6     7     8 
 5508  6960  6982  8645  5325 10648  8663  4592 
```

]

.pull-right45[


&lt;img src="Fitting_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;" /&gt;

]

---

# `postResample()`

.pull-left45[

&lt;ul&gt;
  &lt;li class="m1"&gt;&lt;span&gt;&lt;high&gt;Gives a summary&lt;/high&gt; of a models' performance in a &lt;high&gt;regression task&lt;/high.&lt;/span&gt;&lt;/li&gt;
  &lt;li class="m2"&gt;&lt;span&gt;Specify redicted values and the true values inside the function.&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;br&gt;


```r
# evaluate
postResample(glm_fits,
             basel$income)
```

```
    RMSE Rsquared      MAE 
1173.079    0.821  937.113 
```

]

.pull-right45[

&lt;img src="Fitting_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;" /&gt;

]



---

class: middle, center

&lt;h1&gt;&lt;a href=https://therbootcamp.github.io/ML-DHLab/_sessions/Fitting/Fitting_practical.html&gt;Practical&lt;/a&gt;&lt;/h1&gt;


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
